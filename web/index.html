<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KPInfo CNC - Inicio</title>
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link rel="icon" href="/favicon.ico">
  <style>
    .is-hidden { display: none !important; }
    .link { background:none; border:0; padding:0; color:inherit; text-decoration:underline; cursor:pointer; }
    .login-actions { display:flex; gap:12px; justify-content:center; margin-top:12px; }
  </style>
</head>

<body class="page-login">
  <header class="login-topbar">
    <div class="login-topbar__inner">
      <div class="login-brand">
        <div class="login-brand__title">KPInfo</div>
        <div class="login-brand__subtitle">Sistema de registros para máquinas CNC</div>
      </div>
    </div>
  </header>

  <main class="login-wrap">
    <section class="login-panel">

      <!-- ===================== -->
      <!-- 1) LOGIN (CAPA 2)     -->
      <!-- ===================== -->
      <form id="authLoginForm" class="login-form" novalidate>
        <h2 class="login-title">Iniciar sesión</h2>

        <div class="field">
          <label for="identificador">Email o username</label>
          <input
            id="identificador"
            type="text"
            placeholder="ej: nombre@correo.cl o username"
            autocomplete="username"
            required
          />
        </div>

        <div class="field">
          <label for="password">Contraseña</label>
          <input
            id="password"
            type="password"
            placeholder="Ingrese su contraseña"
            autocomplete="current-password"
            required
          />
        </div>

        <button type="submit" class="btn login-btn">
          Ingresar<br><span>al sistema</span>
        </button>

        <p id="authMsg" class="msg" role="status" aria-live="polite"></p>

        <div class="login-actions" style="margin-top:10px;">
          <a class="link" href="/reset.html">¿Olvidaste tu contraseña?</a>
        </div>


        <div class="login-actions">
          <span>¿No tienes cuenta?</span>
          <button id="showRegisterBtn" type="button" class="link">Crear cuenta</button>
        </div>
      </form>

      <!-- ===================== -->
      <!-- 2) REGISTRO (CAPA 2)  -->
      <!-- (opcional)            -->
      <!-- ===================== -->
      <form id="authRegisterForm" class="login-form is-hidden" novalidate>
        <h2 class="login-title">Registro</h2>

        <div class="field">
          <label for="r_nombre">Nombre</label>
          <input id="r_nombre" type="text" minlength="2" autocomplete="given-name" required />
        </div>

        <div class="field">
          <label for="r_apellido">Apellido</label>
          <input id="r_apellido" type="text" minlength="2" autocomplete="family-name" required />
        </div>

        <div class="field">
          <label for="r_email">Email</label>
          <input id="r_email" type="email" autocomplete="email" required />
        </div>

        <div class="field">
          <label for="r_username">Username (opcional)</label>
          <input id="r_username" type="text" autocomplete="nickname" />
        </div>

        <div class="field">
          <label for="r_password">Contraseña</label>
          <input id="r_password" type="password" minlength="8" autocomplete="new-password" required />
        </div>

        <button type="submit" class="btn">Crear cuenta</button>

        <p id="regMsg" class="msg" role="status" aria-live="polite"></p>

        <div class="login-actions">
          <span>¿Ya tienes cuenta?</span>
          <button id="showLoginBtn" type="button" class="link">Iniciar sesión</button>
        </div>
      </form>

      <!-- opcional: link “cerrar sesión” (aparece si hay token) -->
      <div id="logoutWrap" class="login-actions is-hidden" style="margin-top:18px;">
        <span>¿No era tu cuenta?</span>
        <button id="logoutBtn" type="button" class="link">Cerrar sesión</button>
      </div>

    </section>
  </main>

  <script src="/assets/js/core.js"></script>
  <script src="/assets/js/login.js"></script>
  <script>
    window.KPINIT && window.KPINIT.initLogin && window.KPINIT.initLogin();
  </script>
</body>
</html>
